<% product = price_alert.product %>

<div class="bg-white rounded-lg p-3 shadow-sm hover:shadow-md transition-shadow border border-gray-200">
  <%= link_to product, class: "block mb-2" do %>
    <% if product.image_url.present? %>
      <div class="mb-2 aspect-square rounded overflow-hidden bg-gray-100">
        <%= image_tag product.image_url,
                     alt: product.name,
                     class: "w-full h-full object-cover",
                     loading: "lazy",
                     onerror: "this.style.display='none'" %>
      </div>
    <% end %>
    <h4 class="font-medium text-sm text-gray-900 mb-1 line-clamp-2 group-hover:text-gray-700">
      <%= product.name %>
    </h4>
    <p class="text-xs text-gray-500 truncate">
      <%= URI.parse(product.url) %>
    </p>
  <% end %>

  <div class="space-y-2 text-xs mt-3">
    <div class="flex items-center justify-between">
      <span class="text-gray-500">Current</span>
      <% if product.current_price %>
        <span class="font-semibold text-gray-900">$<%= number_with_precision(product.current_price, precision: 2) %></span>
      <% else %>
        <span class="text-gray-400">--</span>
      <% end %>
    </div>

    <div id="price_alert_<%= price_alert.id %>_card">
      <%= render "price_alerts/alert_target_price_card", price_alert: price_alert %>
    </div>
  </div>

  <%= render 'layouts/delete_modal',
        title: product.name,
        message: "Are you sure you want to delete the price alert?",
        path: price_alert_path(price_alert),
        method: :delete,
        button_text: 'Delete' %>
</div>
