<header class="sticky top-0 z-50 bg-main">
  <nav data-controller="mobile-menu">
    <div data-mobile-menu-target="backdrop"
         data-action="click->mobile-menu#close"
         class="hidden fixed inset-0 bg-black/20 backdrop-blur-sm z-40 lg:hidden">
    </div>

    <div data-mobile-menu-target="header"
         class="flex-auto mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 relative z-50 flex justify-between py-8">
      <div class="relative z-10 flex items-center gap-16">
        <%= link_to root_path, aria: { label: "Home" }, class: "flex items-center gap-2 font-bold text-gray-900 group" do %>
          <svg viewBox="340 80 170 200" class="w-[35px] h-[22px]" xmlns="http://www.w3.org/2000/svg"><style>.hover-rect{width:0;transition:width 0.7s;}.group:hover .hover-rect{width:170px;}</style><path d="M500.033,264.883c-3.503-7.098-78.448-130.636-80.347-133.721c-13.99-22.704-38.24-36.258-64.869-36" class="fill-gray-300"></path><rect class="fill-black hover-rect" height="200" y="80" x="340" clip-path="url(#icon-clip)"></rect><defs><clipPath id="icon-clip"><path d="M500.033,264.883c-3.503-7.098-78.448-130.636-80.347-133.721c-13.99-22.704-38.24-36.258-64.869-36"/></clipPath></defs></svg>
          <span>Seeker</span>
        <% end %>

        <% if authenticated? %>
          <div class="hidden lg:flex lg:gap-10">
            <%= link_to "My Alerts", price_alerts_path, class: "relative -mx-3 -my-2 rounded-lg px-3 py-2 text-sm text-gray-700 transition-colors delay-150 hover:text-gray-900 hover:delay-0" %>
          </div>
        <% end %>
      </div>

      <div class="hidden lg:flex items-center gap-6">
        <% if authenticated? %>
          <div data-controller="user-menu" class="relative">
            <button
              type="button"
              data-action="click->user-menu#toggle"
              class="flex h-8 w-8 items-center justify-center rounded-full bg-brand-500 text-sm font-semibold text-white focus:outline-none cursor-pointer"
              aria-haspopup="true"
            >
              <%= Current.user.username.first.upcase %>
            </button>

            <div
              data-user-menu-target="menu"
              class="absolute right-0 z-20 mt-2 w-48 origin-top-right rounded-md bg-white py-1 shadow-lg ring-1 ring-black/5
                    opacity-0 scale-95 pointer-events-none
                    transition transform ease-out duration-100"
              role="menu"
            >
              <div class="px-4 py-3">
                <div class="flex items-center gap-3">
                  <div class="flex h-8 w-8 items-center justify-center rounded-full bg-brand-500 text-sm font-semibold text-white">
                    <%= Current.user.username.first.upcase %>
                  </div>

                  <div class="text-sm font-medium text-gray-900">
                    <%= Current.user.username %>
                  </div>
                </div>
              </div>

              <div class="mx-4 my-1 h-px bg-gray-100"></div>

              <%= button_to "Sign out", session_path, method: :delete,
                class: "w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 cursor-pointer"
              %>
            </div>
          </div>
        <% else %>
          <%= link_to "Log in", login_path,
                class: "relative inline-flex items-center justify-center px-4 py-2 rounded-full text-base font-medium whitespace-nowrap text-gray-700 hover:bg-gray-300 hover:text-gray-900 transition" %>

          <%= link_to "Sign up", signup_path,
                class: "relative inline-flex items-center justify-center px-4 py-2 rounded-full border border-transparent bg-gray-950 shadow-md text-base font-medium whitespace-nowrap text-white hover:bg-gray-800 transition" %>
        <% end %>
      </div>

      <div class="flex items-center lg:hidden">
        <button
          type="button"
          data-action="click->mobile-menu#toggle"
          class="relative p-2 rounded-full hover:bg-gray-300 transition-colors group"
          aria-label="Toggle menu"
        >
          <svg viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6 text-gray-700">
            <path fill-rule="evenodd" d="M3.748 8.248a.75.75 0 0 1 .75-.75h15a.75.75 0 0 1 0 1.5h-15a.75.75 0 0 1-.75-.75ZM3.748 15.75a.75.75 0 0 1 .75-.751h15a.75.75 0 0 1 0 1.5h-15a.75.75 0 0 1-.75-.75Z" clip-rule="evenodd" />
          </svg>
        </button>
      </div>
    </div>

    <div data-mobile-menu-target="panel"
         class="lg:hidden hidden relative z-50">
      <div class="border-t border-gray-200 bg-white shadow-lg">
        <% if authenticated? %>
          <div class="flex justify-center items-center gap-3 px-6 py-4">
            <div class="flex h-10 w-10 items-center justify-center rounded-full bg-brand-500 text-sm font-semibold text-white">
              <%= Current.user.username.first.upcase %>
            </div>
            <div class="font-medium text-gray-900">
              <%= Current.user.username %>
            </div>
          </div>

          <div class="h-px bg-gray-200"></div>

          <%= link_to "My Alerts", price_alerts_path,
                data: { action: "click->mobile-menu#close" },
                class: "block px-6 py-6 text-center text-base font-medium text-gray-700 hover:bg-gray-100 hover:text-gray-900 rounded-lg transition" %>

          <div class="h-px bg-gray-200"></div>

          <%= button_to "Sign out", session_path, method: :delete,
                class: "w-full px-6 py-6 text-base font-medium text-gray-700 hover:bg-gray-100 hover:text-gray-900 rounded-lg transition cursor-pointer" %>
        <% else %>
          <%= link_to "Log in", login_path,
                data: { action: "click->mobile-menu#close" },
                class: "block py-6 text-center text-base font-medium text-gray-700 hover:bg-gray-100 hover:text-gray-900 transition" %>

          <div class="h-px bg-gray-200"></div>

          <%= link_to "Sign up", signup_path,
                data: { action: "click->mobile-menu#close" },
                class: "block py-6 text-center text-base font-medium text-gray-700 hover:bg-gray-100 hover:text-gray-900 transition" %>
        <% end %>
      </div>
    </div>
  </nav>
</header>
